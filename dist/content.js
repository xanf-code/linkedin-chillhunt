(()=>{console.log("LinkedIn Jobs Helper content script loaded");let e=!1,o=!1,t=!1,n=[],s=!1;function r(e){s&&console.log(`LinkedIn Jobs Helper Debug: ${e}`)}function l(){document.querySelectorAll("li.ember-view.occludable-update[data-occludable-job-id], li.scaffold-layout__list-item[data-occludable-job-id]").forEach(((e,o)=>{try{if(e.querySelector(".ch-block-btn"))return;const t=e.querySelector(".artdeco-entity-lockup__subtitle")||e.querySelector(".job-card-container__company-name")||e.querySelector("[data-test-job-card-company-name]");if(!t)return;const s=t.textContent.trim();if(!s)return;const l=document.createElement("button");l.className="ch-block-btn",l.setAttribute("aria-label",`Block ${s}`),l.setAttribute("type","button"),l.style.cssText="\n        position: absolute;\n        bottom: 12px;\n        right: 12px;\n        z-index: 9999;\n        width: 32px;\n        height: 32px;\n        background-color: #ff5c5c;\n        border-radius: 50%;\n        border: 2px solid #ffffff;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        opacity: 0.9;\n        transition: all 0.2s ease;\n      ",l.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">\n          <circle cx="12" cy="12" r="10"></circle>\n          <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>\n        </svg>\n      ',l.onmouseover=function(){this.style.opacity="1",this.style.transform="scale(1.1)"},l.onmouseout=function(){this.style.opacity="0.9",this.style.transform="scale(1)"},l.addEventListener("click",(o=>{o.preventDefault(),o.stopPropagation(),function(e,o){n.includes(e)||(n.push(e),r(`Blocked company: ${e}`),chrome.storage.sync.set({blockedCompanies:n},(function(){r("Blocked companies list saved")})),o&&(o.style.display="none"),c())}(s,e)})),"static"===window.getComputedStyle(e).position&&(e.style.position="relative"),e.appendChild(l),console.log(`Added block button for ${s} to card ${o}`)}catch(e){console.error(`Error adding block button to card ${o}: ${e.message}`)}}))}function c(){try{const s=document.querySelectorAll("li.ember-view.occludable-update, li.scaffold-layout__list-item");r(`Processing ${s.length} job cards`);let l=0;s.forEach(((s,c)=>{try{let i=!1,a="";if(!i&&n.length>0)try{const e=s.querySelector(".artdeco-entity-lockup__subtitle");if(e){const o=e.textContent.trim();n.includes(o)&&(i=!0,a="blocked company")}}catch(e){r(`Error checking blocked company status: ${e.message}`)}if(!i&&e&&s.querySelectorAll(".job-card-container__footer-item").forEach((e=>{try{e.textContent.trim().includes("Promoted")&&(i=!0,a="promoted")}catch(e){r(`Error checking promoted status: ${e.message}`)}})),!i&&o)try{const e=s.querySelector(".job-card-container__footer-job-state");e&&"Viewed"===e.textContent.trim()&&(i=!0,a="viewed")}catch(e){r(`Error checking viewed status: ${e.message}`)}if(!i&&t)try{const e=s.querySelector('button[aria-label="Easy Apply"], span[data-test-icon="linkedin-bug-color-small"]'),o=s.textContent.includes("Easy Apply"),t=Array.from(s.querySelectorAll("span")).some((e=>"Easy Apply"===e.textContent.trim()));(e||o||t)&&(i=!0,a="easy apply")}catch(e){r(`Error checking easy apply status: ${e.message}`)}i?(s.style.display="none",l++,r(`Hiding job #${c+1} (reason: ${a})`)):s.style.display=""}catch(e){r(`Error processing job card ${c}: ${e.message}`)}})),r(`Hidden ${l} of ${s.length} jobs`)}catch(e){console.error(`LinkedIn Jobs Helper error: ${e.message}`)}setTimeout(l,100)}function i(){try{const s=document.querySelector(".jobs-search-results-list, .scaffold-layout__list");s?(r("Job list container found, setting up observer"),new MutationObserver((function(s){try{e||o||t||n.length>0?setTimeout(c,100):setTimeout(l,100)}catch(e){r(`Observer callback error: ${e.message}`)}})).observe(s,{childList:!0,subtree:!0}),r("Observer successfully attached"),e||o||t||n.length>0?c():setTimeout(l,100)):(r("Job list container not found, retrying in 1s"),setTimeout(i,1e3))}catch(e){console.error(`LinkedIn Jobs Helper observer setup error: ${e.message}`),setTimeout(i,2e3)}}window.toggleLinkedInJobsHelperDebug=function(){s=!s,console.log("LinkedIn Jobs Helper Debug Mode: "+(s?"ON":"OFF")),s&&(console.log("To turn off debug mode, run: toggleLinkedInJobsHelperDebug()"),console.log(`Current settings: hidePromoted=${e}, hideViewed=${o}, hideEasyApply=${t}`),console.log(`Blocked companies: ${JSON.stringify(n)}`),function(){const e=document.querySelectorAll("li.ember-view.occludable-update, li.scaffold-layout__list-item");console.log(`Found ${e.length} job cards on page`),e.length>0&&e.forEach(((e,o)=>{if(o<3){console.log(`Job Card #${o+1}:`);const t=e.querySelectorAll(".job-card-container__footer-item");let s=!1;t.forEach((e=>{const o=e.textContent.trim();o.includes("Promoted")&&(s=!0,console.log(`- Has "Promoted" tag: Yes (Text: "${o}")`))})),s||console.log('- Has "Promoted" tag: No');const r=e.querySelector(".job-card-container__footer-job-state");r?console.log(`- Has "Viewed" tag: ${"Viewed"===r.textContent.trim()?"Yes":"No"} (Text: "${r.textContent.trim()}")`):console.log('- Has "Viewed" tag: No (element not found)'),e.querySelector('span[data-test-icon="linkedin-bug-color-small"], span.artdeco-inline-feedback__message, span[aria-hidden="true"]:contains("Easy Apply")')?console.log('- Has "Easy Apply": Yes'):console.log('- Has "Easy Apply": No (element not found)');const l=e.querySelector(".artdeco-entity-lockup__subtitle");if(l){const e=l.textContent.trim();console.log(`- Company: ${e}`),console.log(`- Blocked: ${n.includes(e)}`)}const c=e.querySelector('button[aria-label*="Dismiss"], button[aria-label*="dismiss"]');console.log("- Dismiss button found: "+(c?"Yes":"No")),c&&(console.log(`  - Button classes: ${c.className}`),console.log(`  - Button parent: ${c.parentNode.tagName}`))}}))}())};try{chrome.storage.onChanged.addListener((function(s){try{s.hidePromoted&&(e=s.hidePromoted.newValue,r(`hidePromoted changed to ${e}`)),s.hideViewed&&(o=s.hideViewed.newValue,r(`hideViewed changed to ${o}`)),s.hideEasyApply&&(t=s.hideEasyApply.newValue,r(`hideEasyApply changed to ${t}`)),s.blockedCompanies&&(n=s.blockedCompanies.newValue||[],r(`blockedCompanies changed to ${JSON.stringify(n)}`)),c()}catch(e){console.error(`LinkedIn Jobs Helper settings change handler error: ${e.message}`)}}))}catch(e){console.error(`LinkedIn Jobs Helper failed to set up storage listener: ${e.message}`)}document.addEventListener("scroll",(e=>{let o;return function(){clearTimeout(o),o=setTimeout((()=>e.apply(this,arguments)),500)}})((function(){try{e||o||t||n.length>0?c():l()}catch(e){r(`Scroll handler error: ${e.message}`)}})));try{r("Initializing LinkedIn Jobs Helper"),function(){try{chrome.storage.sync.get({hidePromoted:!1,hideViewed:!1,hideEasyApply:!1,blockedCompanies:[]},(function(s){try{e=s.hidePromoted,o=s.hideViewed,t=s.hideEasyApply,n=s.blockedCompanies||[],r(`Settings loaded: hidePromoted=${e}, hideViewed=${o}, hideEasyApply=${t}`),r(`Blocked companies loaded: ${JSON.stringify(n)}`),e||o||t||n.length>0?c():setTimeout(l,100)}catch(e){console.error(`LinkedIn Jobs Helper error loading settings: ${e.message}`)}}))}catch(e){console.error(`LinkedIn Jobs Helper failed to access storage: ${e.message}`)}}(),"complete"===document.readyState?i():window.addEventListener("load",(function(){i()}))}catch(e){console.error(`LinkedIn Jobs Helper initialization error: ${e.message}`)}})();